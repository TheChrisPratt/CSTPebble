<!DOCTYPE html>
<html>
  <head>
    <title>CST Big Time Settings</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" />
  </head>
  <body>
      <!-- Header -->
    <h4 style="margin-left:25px; padding-bottom:10px">Choose your settings:</h4>
      <!-- Settings Table -->
    <table>
      <tr>
        <th>Choose an option:</th>
      </tr>
      <tr>
        <td><input type="checkbox" id="zero_prefix" style="width:100px; margin-left:20px;"> <label for="zero_prefix">Zero Prefix Hour Value?</label></td>
      </tr>
      <tr>
        <td><input type="checkbox" id="show_power" style="width:100px; margin-left:20px;"> <label for="show_power">Show Power Level Indicator?</label></td>
      </tr>
      <tr>
        <td><input type="checkbox" id="show_btooth" style="width:100px; margin-left:20px;"> <label for="show_btooth">Show Bluetooth Indicator?</label></td>
      </tr>
    </table>
    <p style="text-align:center;"><button type="button" class="submit btn btn-success" style="width:100px;margin-top:20px;">Submit</button>
      <!-- Footer -->
    <br />
    <footer style="width:200px;">
      <p style="text-align:center;">Created by Anodyzed</p>
    </footer>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>
      $(function() {
        window.applicationCache.addEventListener("updateready",onUpdateReady);
        function onUpdateReady () {
          if(window.applicationCache.status === window.applicationCache.UPDATEREADY) {
            window.location.reload();
          }
        } //onUpdateReady

        var dictionary;
        try {
          dictionary = JSON.parse(localStorage["dictionary"]);
        } catch(x) {
          dictionary = { 
            zero_prefix: "false",
            show_power: "true",
            show_btooth: "true"
          };
        }
        for(option in dictionary) {
          if(dictionary[option]) {
              /* Option */
            if((option == "zero_prefix") || (option == "show_power") || (option == "show_btooth")) {
              $('#' + option).prop("checked",(dictionary[option] == "true"));
            } else if(option == "test") {
                // Remove the "test" element
              delete(dictionary[option]);
              localStorage["dictionary"] = JSON.stringify(dictionary);
            }
          }
        }

        $(":checkbox").on("change",function() {
          dictionary[$(this).attr("id")] = (this.checked) ? "true" : "false";
          localStorage["dictionary"] = JSON.stringify(dictionary);
        });

        $(".submit").click(function() {
          console.log(JSON.stringify(dictionary));
          window.location.href = "pebblejs://close#" + encodeURIComponent(JSON.stringify(dictionary));
        });
      });
    </script>
  </body>
</html>